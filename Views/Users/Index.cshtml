@model IEnumerable<Gym.Models.User>
@{
    ViewData["Title"] = "Manage Users";
    var selectedRole = ViewBag.SelectedRole as string;
    var search = ViewBag.Search as string;
}

<div class="vh-100 position-relative text-white" style="background: linear-gradient(115deg, rgba(0,0,0,0.85) 35%, rgba(0,0,0,0.4) 80%),
             url('/images/bg.jpg') no-repeat center right / cover;
             overflow: hidden;">

    <!-- إضاءة صفراء خفيفة زي صفحة الاشتراكات -->
    <div style="position:absolute; top:0; right:-100px; width:450px; height:100%;
                background: radial-gradient(circle at 30% 50%, rgba(255, 193, 7, 0.25), transparent 75%);
                filter: blur(50px); opacity: 0.8;"></div>

    <div class="container py-5" style="position: relative; z-index:2;">

        <h2 class="mb-4 text-warning fw-bold text-center">Manage Users</h2>

        <!-- فورم البحث والفلترة -->
        <form method="get" class="row g-2 justify-content-center mb-4">
            <div class="col-12 col-md-5">
                <input type="text" name="search" value="@search" class="form-control"
                    placeholder="Search by name or email..." />
            </div>

            <div class="col-6 col-md-3">
                <select name="role" class="form-select">
                    <option value="All"
                        selected="@(string.IsNullOrEmpty(selectedRole) || selectedRole == "All" ? "selected" : null)">
                        All Roles
                    </option>
                    <option value="Admin" selected="@(selectedRole == "Admin" ? "selected" : null)">
                        Admin
                    </option>
                    <option value="Trainer" selected="@(selectedRole == "Trainer" ? "selected" : null)">
                        Trainer
                    </option>
                    <option value="Trainee" selected="@(selectedRole == "Trainee" ? "selected" : null)">
                        Trainee
                    </option>
                </select>
            </div>

            <div class="col-3 col-md-2 d-grid">
                <button type="submit" class="btn btn-light">
                    Apply
                </button>
            </div>

            <div class="col-3 col-md-2 d-grid">
                <a asp-action="Index" class="btn btn-outline-light">
                    Delete Filters
                </a>
            </div>
        </form>

        <!-- جدول اليوزرز -->
        <div class="table-responsive shadow-lg rounded">
            <table class="table table-dark table-striped table-bordered align-middle text-center users-table">
                <thead class="table-warning text-dark">
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Username</th>
                        <th scope="col">Email</th>
                        <th scope="col">Role</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @if (!Model.Any())
                    {
                        <tr>
                            <td colspan="5" class="text-center text-muted py-4">
                                There are no results matching the current search criteria. </td>
                        </tr>
                    }
                    else
                    {
                        @foreach (var user in Model)
                        {
                            <tr>
                                <td>@user.Id</td>
                                <td>@user.Username</td>
                                <td>@user.Email</td>
                                <td>@user.Role</td>
                                <td class="d-flex justify-content-center gap-2">
                                    <a href="@Url.Action("Edit", new { id = user.Id })" class="btn btn-sm btn-primary">
                                        Edit
                                    </a>
                                    <a href="@Url.Action("Delete", new { id = user.Id })" class="btn btn-sm btn-danger"
                                        onclick="return confirm('Are you sure you want to delete this user?');">
                                        Delete
                                    </a>
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>

    </div>
</div>

<style>
    .table thead {
        background-color: rgba(255, 193, 7, 0.9) !important;
        color: #000 !important;
    }

    /* الصف يتلون بس عند الهовер – من غير أي حركات تانية */
    .users-table tbody tr:hover {
        background-color: rgba(255, 193, 7, 0.2);
        transition: background 0.2s;
    }

    .btn-warning {
        background-color: #ffc107;
        border-color: #ffc107;
        color: #000;
        font-weight: 600;
    }

    .btn-primary {
        background-color: #0d6efd;
        border-color: #0d6efd;
    }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    .table-responsive {
        border-radius: 0.5rem;
        overflow: hidden;
    }

    h2 {
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    }
</style>